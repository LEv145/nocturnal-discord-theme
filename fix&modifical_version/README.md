Version with fixed bugs and changed design
